<?php //require_once('./include/mysqli_connect.php');$con = new PDO('mysql:host=localhost;dbname=mywschoo_db', 'root', '');	$con->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);// headers for exporting excelheader("Content-Disposition: attachment; filename='contacts.xls'");header("Content-Type: application/vnd.ms-excel");function dataFilter(&$str_val){	$str_val = preg_replace("/\t/", "\\t", $str_val);	$str_val = preg_replace("/\r?\n/", "\\n", $str_val);	if(strstr($str_val, '"')) $str_val = '"' . str_replace('"', '""', $str_val) . '"';}$post_list = array();//get rows query$query = $con->prepare("SELECT first_name,middle_name,last_name,address,contact_no1,contact_no2,email_address FROM tbl_contacts ORDER BY contact_id ASC");							$query->execute();//$query = mysqli_query($con, "SELECT * FROM li_ajax_post_load ORDER BY post_id DESC limit 0,5");//number of rows  $sno = 1; "Sno"=>$sno,$rowCount = $query->rowCount();if($rowCount > 0){	while($row = $query->fetch(PDO::FETCH_ASSOC)){		$post_list[] = array("first name"=>$row["first_name"],"middle name"=>$row["middle_name"],"last name"=>$row["last_name"],"address"=>$row["address"],"contact no1"=>$row["contact_no1"],"contact no2"=>$row["contact_no2"],"email address"=>$row["email_address"]);		//$sno++;	}}$title_flag = false;foreach($post_list as $post) {	if(!$title_flag) {		// Showing column names 		echo implode("\t", array_keys($post)) . "\n";		$title_flag = true;	}	// data filtering	array_walk($post, 'dataFilter');	echo implode("\t", array_values($post)) . "\n";}?>