!function(i){i.fn.autoComplete=function(t){var l=i.extend({},i.fn.autoComplete.defaults,t);return"string"==typeof t?(this.each(function(){var e=i(this);"destroy"==t&&(i(window).off("resize.autocomplete",e.updateSC),e.off("blur.autocomplete focus.autocomplete keydown.autocomplete keyup.autocomplete"),e.data("autocomplete")?e.attr("autocomplete",e.data("autocomplete")):e.removeAttr("autocomplete"),i(e.data("sc")).remove(),e.removeData("sc").removeData("autocomplete"))}),this):this.each(function(){function a(e){var t=c.val();if((c.cache[t]=e).length&&t.length>=l.minChars){for(var o="",s=0;s<e.length;s++)o+=l.renderItem(e[s],t);c.sc.html(o),c.updateSC(0)}else c.sc.hide()}var c=i(this);c.sc=i('<div class="autocomplete-suggestions '+l.menuClass+'"></div>'),c.data("sc",c.sc).data("autocomplete",c.attr("autocomplete")),c.attr("autocomplete","off"),c.cache={},c.last_val="",c.updateSC=function(e,t){if(c.sc.css({top:c.offset().top+c.outerHeight(),left:c.offset().left,width:c.outerWidth()}),!e&&(c.sc.show(),c.sc.maxHeight||(c.sc.maxHeight=parseInt(c.sc.css("max-height"))),c.sc.suggestionHeight||(c.sc.suggestionHeight=i(".autocomplete-suggestion",c.sc).first().outerHeight()),c.sc.suggestionHeight))if(t){var o=c.sc.scrollTop(),s=t.offset().top-c.sc.offset().top;0<s+c.sc.suggestionHeight-c.sc.maxHeight?c.sc.scrollTop(s+c.sc.suggestionHeight+o-c.sc.maxHeight):s<0&&c.sc.scrollTop(s+o)}else c.sc.scrollTop(0)},i(window).on("resize.autocomplete",c.updateSC),c.sc.appendTo("body"),c.sc.on("mouseleave",".autocomplete-suggestion",function(){i(".autocomplete-suggestion.selected").removeClass("selected")}),c.sc.on("mouseenter",".autocomplete-suggestion",function(){i(".autocomplete-suggestion.selected").removeClass("selected"),i(this).addClass("selected")}),c.sc.on("mousedown click",".autocomplete-suggestion",function(e){var t=i(this),o=t.data("val");return(o||t.hasClass("autocomplete-suggestion"))&&(c.val(o),l.onSelect(e,o,t),c.sc.hide()),!1}),c.on("blur.autocomplete",function(){try{over_sb=i(".autocomplete-suggestions:hover").length}catch(e){over_sb=0}over_sb?c.is(":focus")||setTimeout(function(){c.focus()},20):(c.last_val=c.val(),c.sc.hide(),setTimeout(function(){c.sc.hide()},350))}),l.minChars||c.on("focus.autocomplete",function(){c.last_val="\n",c.trigger("keyup.autocomplete")}),c.on("keydown.autocomplete",function(e){var t;if((40==e.which||38==e.which)&&c.sc.html())return(o=i(".autocomplete-suggestion.selected",c.sc)).length?(t=40==e.which?o.next(".autocomplete-suggestion"):o.prev(".autocomplete-suggestion")).length?(o.removeClass("selected"),c.val(t.addClass("selected").data("val"))):(o.removeClass("selected"),c.val(c.last_val),t=0):(t=40==e.which?i(".autocomplete-suggestion",c.sc).first():i(".autocomplete-suggestion",c.sc).last(),c.val(t.addClass("selected").data("val"))),c.updateSC(0,t),!1;if(27==e.which)c.val(c.last_val).sc.hide();else if(13==e.which||9==e.which){var o=i(".autocomplete-suggestion.selected",c.sc);o.length&&c.sc.is(":visible")&&(l.onSelect(e,o.data("val"),o),setTimeout(function(){c.sc.hide()},20))}}),c.on("keyup.autocomplete",function(e){if(!~i.inArray(e.which,[13,27,35,36,37,38,39,40])){var t=c.val();if(t.length>=l.minChars){if(t!=c.last_val){if(c.last_val=t,clearTimeout(c.timer),l.cache){if(t in c.cache)return void a(c.cache[t]);for(var o=1;o<t.length-l.minChars;o++){var s=t.slice(0,t.length-o);if(s in c.cache&&!c.cache[s].length)return void a([])}}c.timer=setTimeout(function(){l.source(t,a)},l.delay)}}else c.last_val=t,c.sc.hide()}})})},i.fn.autoComplete.defaults={source:0,minChars:3,delay:150,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(e,t,o){}}}(jQuery);